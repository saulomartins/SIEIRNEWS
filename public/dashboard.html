<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Monitoramento de Ativos - SIEIRNEWS</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gridstack@10.1.2/dist/gridstack.min.css">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <!-- Header Premium -->
  <nav class="navbar navbar-dark premium-header">
    <div class="container-fluid py-2">
      <div class="d-flex align-items-center">
        <img src="images/logo.png" alt="SEIER TRADER" class="logo-img me-2 me-md-3">
        <div class="logo-text">
          <h1 class="mb-0 text-gold">SEIER TRADER</h1>
          <p class="mb-0 text-silver small d-none d-md-block">Professional Stock Market Dashboard</p>
        </div>
      </div>
      <div class="d-flex flex-column flex-sm-row gap-2">
        <button class="btn btn-gold btn-sm" data-bs-toggle="modal" data-bs-target="#addTickerModal">
          <i class="bi bi-plus-circle"></i> <span class="d-none d-sm-inline">Adicionar</span><span class="d-sm-none">Add</span>
        </button>
        <button class="btn btn-outline-gold btn-sm" id="logoutBtn">
          <i class="bi bi-box-arrow-right"></i> <span class="d-none d-sm-inline">Sair</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container-fluid mt-4 premium-content">
    <div class="row mb-3">
      <div class="col-12">
        <div class="d-flex flex-column flex-lg-row justify-content-between align-items-start align-items-lg-center premium-section gap-2">
          <h4 class="text-gold mb-0">
            <i class="bi bi-grid-3x3-gap"></i> <span class="d-none d-sm-inline">Dashboard Personalizável</span><span class="d-sm-none">Dashboard</span>
            <span class="badge bg-live ms-2" id="liveIndicator">
              <i class="bi bi-broadcast"></i> <span class="d-none d-md-inline">AO VIVO</span><span class="d-md-none">LIVE</span>
            </span>
          </h4>
          <div class="d-flex flex-column flex-sm-row align-items-start align-items-sm-center gap-2 w-100 w-lg-auto">
            <span class="text-silver small" id="lastUpdate">
              <i class="bi bi-clock"></i> <span class="d-none d-md-inline">Última atualização:</span> -
            </span>
            <div class="d-flex gap-2 flex-wrap">
              <button class="btn btn-info btn-sm" id="freezeBtn">
                <i class="bi bi-pause-circle"></i> <span class="d-none d-md-inline">Congelar</span>
              </button>
              <button class="btn btn-warning btn-sm d-none" id="unfreezeBtn">
                <i class="bi bi-play-circle"></i> <span class="d-none d-md-inline">Descongelar</span>
              </button>
              <button class="btn btn-gold btn-sm" id="refreshBtn">
                <i class="bi bi-arrow-clockwise"></i> <span class="d-none d-sm-inline">Atualizar</span>
              </button>
              <button class="btn btn-secondary btn-sm" id="resetColumnsBtn">
                <i class="bi bi-arrow-counterclockwise"></i> <span class="d-none d-sm-inline">Resetar Tamanho</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="alert-container"></div>

    <!-- Info Banner Premium -->
    <div class="row mb-3">
      <div class="col-12">
        <div class="alert premium-alert alert-dismissible fade show" role="alert">
          <h6 class="alert-heading mb-2 text-gold">
            <i class="bi bi-info-circle-fill"></i> Horários de Atualização
          </h6>
          <div class="row small text-silver">
            <div class="col-12 col-md-6 mb-2 mb-md-0">
              <strong><i class="bi bi-clock-history"></i> MERCADO (11:30-18:00):</strong> 
              <span class="d-none d-lg-inline">Horário atualizado a cada 1 minuto durante o pregão. Após 18h, mostra apenas a data.</span>
              <span class="d-lg-none">Atualização a cada 1 min no pregão</span>
            </div>
            <div class="col-12 col-md-6">
              <strong><i class="bi bi-sunrise"></i> PRE-MARKET (19:20-10:59):</strong> 
              <span class="d-none d-lg-inline">Horário atualizado a cada 1 minuto nas negociações estendidas (After Hours e Pre-Market).</span>
              <span class="d-lg-none">Atualização a cada 1 min (After Hours)</span>
            </div>
          </div>
          <div class="mt-2">
            <small class="text-silver">
              <i class="bi bi-arrow-repeat"></i> <span class="d-none d-md-inline">Os <strong>preços e variações</strong> são atualizados automaticamente a cada <strong>1 segundo</strong> em tempo real.</span>
              <span class="d-md-none">Atualização automática a cada <strong>1 segundo</strong></span>
            </small>
          </div>
          <div class="mt-2">
            <small class="text-gold">
              <i class="bi bi-arrows-move"></i> <strong>Dica:</strong> Arraste os painéis para reorganizar, redimensione pelos cantos e adicione novos componentes
            </small>
          </div>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      </div>
    </div>

    <!-- Tabela de Ações -->
    <div class="row">
      <div class="col-12">
        <div class="premium-section">
          <div id="tableContainer" class="table-responsive" style="position: relative; width: 100%; height: auto; min-width: 600px; min-height: 300px;">
            <!-- Handles de redimensionamento -->
            <div class="resize-handle resize-handle-n" data-direction="top"></div>
            <div class="resize-handle resize-handle-s" data-direction="bottom"></div>
            <div class="resize-handle resize-handle-e" data-direction="right"></div>
            <div class="resize-handle resize-handle-w" data-direction="left"></div>
            <div class="resize-handle resize-handle-se" data-direction="corner-br"></div>
            
            <table class="table table-dark table-hover table-striped">
              <thead>
                <tr>
                  <th rowspan="2" class="align-middle text-center">TICKER</th>
                  <th colspan="2" class="text-center">MERCADO</th>
                  <th colspan="2" class="text-center">PRÉ-MARKET</th>
                  <th colspan="2" class="text-center frozen-column" style="display: none;">DADOS CONGELADOS</th>
                  <th rowspan="2" class="align-middle text-center">AÇÕES</th>
                </tr>
                <tr>
                  <th class="text-center">VALOR</th>
                  <th class="text-center">VAR.%</th>
                  <th class="text-center">VALOR</th>
                  <th class="text-center">VAR.%</th>
                  <th class="text-center frozen-column" style="display: none;">VAR.% Congelada</th>
                  <th class="text-center frozen-column" style="display: none;">Comparação</th>
                </tr>
              </thead>
              <tbody id="tickersContainer">
                <tr>
                  <td colspan="8" class="text-center">
                    <div class="spinner-border text-gold" role="status">
                      <span class="visually-hidden">Carregando...</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para Adicionar Ticker -->
  <div class="modal fade" id="addTickerModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            <i class="bi bi-plus-circle"></i> Adicionar Novo Ativo
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="addTickerForm">
            <div class="mb-3">
              <label for="tickerInput" class="form-label">Símbolo do Ativo (Ticker)</label>
              <input 
                type="text" 
                class="form-control text-uppercase" 
                id="tickerInput" 
                placeholder="Ex: AAPL, GOOGL, MSFT"
                required
                maxlength="10"
              >
              <div class="form-text">
                Digite o símbolo do ativo do Yahoo Finance (ex: TSLA, AAPL, GOOGL)
              </div>
            </div>
            <div id="modal-alert-container"></div>
          </form>
        </div>
        <div class="modal-footer premium-modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" form="addTickerForm" class="btn btn-gold">
            <i class="bi bi-plus"></i> Adicionar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para Adicionar Novo Painel -->
  <div class="modal fade" id="addPanelModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            <i class="bi bi-plus-square"></i> Adicionar Novo Painel
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p class="text-silver mb-3">Escolha o tipo de painel que deseja adicionar ao dashboard:</p>
          <div class="row g-3">
            <div class="col-12">
              <button class="btn btn-gold w-100 py-3 panel-option" data-type="table" data-title="Monitoramento de Ações">
                <i class="bi bi-table fs-3 d-block mb-2"></i>
                <strong>Tabela de Ativos</strong>
                <small class="d-block text-muted">Monitoramento de ações em tempo real</small>
              </button>
            </div>
            <div class="col-12">
              <button class="btn btn-outline-gold w-100 py-3 panel-option" data-type="chart" data-title="Gráfico">
                <i class="bi bi-graph-up fs-3 d-block mb-2"></i>
                <strong>Gráfico</strong>
                <small class="d-block text-muted">Visualização de dados (em breve)</small>
              </button>
            </div>
            <div class="col-12">
              <button class="btn btn-outline-gold w-100 py-3 panel-option" data-type="news" data-title="Notícias">
                <i class="bi bi-newspaper fs-3 d-block mb-2"></i>
                <strong>Notícias</strong>
                <small class="d-block text-muted">Feed de notícias financeiras (em breve)</small>
              </button>
            </div>
            <div class="col-12">
              <button class="btn btn-outline-gold w-100 py-3 panel-option" data-type="custom" data-title="Painel Personalizado">
                <i class="bi bi-card-text fs-3 d-block mb-2"></i>
                <strong>Painel Personalizado</strong>
                <small class="d-block text-muted">Adicione conteúdo customizado</small>
              </button>
            </div>
          </div>
        </div>
        <div class="modal-footer premium-modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Fechar</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/dashboard-old.js"></script>
</body>
</html>
